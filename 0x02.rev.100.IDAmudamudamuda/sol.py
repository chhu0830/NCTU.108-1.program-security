#!/usr/bin/env python2
# -*- coding: utf-8 -*-

from pwn import *


code = '\x45\x7b\xdc\x41\xb7\x35\xec\xf0\xf0\xf0\xf0\xdb\xf9\x7b\x35\xec\x73\xb0\xf1\x79\x35\xec\x7b\x3d\xfc\xf3\x3d\xec\xff\xae\x01\x75\xc2\x64\x15\x7b\x35\xf8\xf3\x35\xec\xff\xae\xf8\x73\xb1\x13\x73\xe1\x56\xff\xae\xc1\x7b\x35\xfc\xf3\x35\xec\xff\xae\xf8\x2b\xc1\x64\xf4\x23\xb0\xdb\xf7\xdb\xb5\xa8\xf1\xf0\xf0\xf0\x7b\xd5\x4d\xb3'


# first command should be `push ebp`
d = ord(asm('push ebp')) - 0x45

print disasm(''.join([chr((ord(c)+d+256)%256) for c in code]))


key = '\x0f\x09\x02\x0c\xf8\xfa\x30\xf0\x22\x22\xfa\x30\xf0\x22\x22\xfa\x30\xf0\x22\x22\x35\xed\xe4\xf6\xfa\xe4\xec\x35\xe1\x22\x22\xc6'

print ''.join([chr((ord(key[i]) ^ 0x66) - 0x23) for i in range(32)])
